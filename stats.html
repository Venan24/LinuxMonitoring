<!DOCTYPE html>
<!--
Template Name: Metronic - Responsive Admin Dashboard Template build with Twitter Bootstrap 3.3.6
Version: 4.5.4
Author: KeenThemes
Website: http://www.keenthemes.com/
Contact: support@keenthemes.com
Follow: www.twitter.com/keenthemes
Like: www.facebook.com/keenthemes
Purchase: http://themeforest.net/item/metronic-responsive-admin-dashboard-template/4021469?ref=keenthemes
License: You must have a valid license purchased only from themeforest(the above link) in order to legally use the theme for your project.
-->
<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en">
<!--<![endif]-->
<!-- BEGIN HEAD -->

<head>
  <meta charset="utf-8" />
  <title>Server Monitoring</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <meta content="" name="description" />
  <meta content="" name="author" />
  <!-- BEGIN GLOBAL MANDATORY STYLES -->
  <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700&subset=all" rel="stylesheet" type="text/css" />
  <link href="css/font-awesome.min.css" rel="stylesheet" type="text/css" />
  <link href="css/simple-line-icons.min.css" rel="stylesheet" type="text/css" />
  <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css" />

  <link href="css/components-rounded.min.css" rel="stylesheet" id="style_components" type="text/css" />
  <!-- END THEME GLOBAL STYLES -->
  <!-- BEGIN PAGE LEVEL STYLES -->
  <link href="css/profile.min.css" rel="stylesheet" type="text/css" />
  <!-- END PAGE LEVEL STYLES -->
  <!-- BEGIN THEME LAYOUT STYLES -->
  <link href="css/layout.min.css" rel="stylesheet" type="text/css" />
  <link href="css/themes/blue.min.css" rel="stylesheet" type="text/css" id="style_color" />
  <link href="css/custom.min.css" rel="stylesheet" type="text/css" />
  <link href="bower_components/bootstrap-sweetalert/dist/sweetalert.css" rel="stylesheet" type="text/css" />
  <!-- END THEME LAYOUT STYLES -->
  <link rel="shortcut icon" href="favicon.ico" /> </head>
<!-- END HEAD -->

<body class="page-header-fixed page-container-bg-solid page-content-white" style="background-color: #eef1f5; display: none;">
  <!-- BEGIN HEADER -->
  <div class="page-header navbar navbar-fixed-top">
    <!-- BEGIN HEADER INNER -->
    <div class="page-header-inner ">
      <!-- BEGIN LOGO -->
      <div class="page-logo">
        <a href="index.html"><img src="img/logo.png" alt="logo" class="logo-default" /> </a>
      </div>
      <!-- END LOGO -->
      <!-- BEGIN RESPONSIVE MENU TOGGLER -->
      <a href="javascript:;" class="menu-toggler responsive-toggler" data-toggle="collapse" data-target=".navbar-collapse"> </a>
      <!-- END RESPONSIVE MENU TOGGLER -->
      <!-- BEGIN TOP NAVIGATION MENU -->
      <div class="top-menu">
        <ul class="nav navbar-nav pull-right">
          <li class="dropdown dropdown-user">
            <a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown" data-close-others="true">
                                <img class="profile-image img-circle" />
                                <span class="profile-name username username-hide-on-mobile">Venan Osmic </span>
                                <i class="fa fa-angle-down"></i>
                            </a>
            <ul class="dropdown-menu dropdown-menu-default">
              <li>
                <a target="_blank" href="https://myaccount.google.com/">
                                        <i class="icon-user"></i> My Profile </a>
              </li>
              <li>
                <a href="javascript:;create_new_server();">
                                        <i class="icon-plus"></i> Add New Machine </a>
              </li>
            </ul>
          </li>
          <!-- END USER LOGIN DROPDOWN -->
          <!-- BEGIN QUICK SIDEBAR TOGGLER -->
          <!-- DOC: Apply "dropdown-dark" class after below "dropdown-extended" to change the dropdown styte -->
          <li class="dropdown dropdown-quick-sidebar-toggler">
            <a href="javascript:;Login.logout()" class="dropdown-toggle">
                                <i class="icon-logout"></i>
                            </a>
          </li>
          <!-- END QUICK SIDEBAR TOGGLER -->
        </ul>
      </div>
      <!-- END TOP NAVIGATION MENU -->
    </div>
    <!-- END HEADER INNER -->
  </div>
  <!-- END HEADER -->
  <!-- BEGIN HEADER & CONTENT DIVIDER -->
  <div class="clearfix"> </div>
  <!-- END HEADER & CONTENT DIVIDER -->
  <!-- BEGIN CONTAINER -->
  <div class="page-container">

    <!-- BEGIN CONTENT -->
    <div class="page-content-wrapper">
      <!-- BEGIN CONTENT BODY -->
      <div class="page-content" style="margin-left: 0px;">
        <!-- BEGIN PAGE HEADER-->
        <!-- END PAGE HEADER-->
        <div class="row">
          <div class="col-md-12">
            <!-- BEGIN PROFILE SIDEBAR -->
            <div class="profile-sidebar">
              <!-- PORTLET MAIN -->
              <div class="portlet light profile-sidebar-portlet ">
                <!-- SIDEBAR USERPIC -->
                <div class="profile-userpic">
                  <img class="profile-image img-responsive" alt=""> </div>
                <!-- END SIDEBAR USERPIC -->
                <!-- SIDEBAR USER TITLE -->
                <div class="profile-usertitle">
                  <div class="profile-name profile-usertitle-name"> Venan Osmic </div>
                  <div id="profile-email" class="profile-usertitle-name"> venanosmic24@gmail.com </div>
                </div>
                <!-- END SIDEBAR USER TITLE -->

                <!-- SIDEBAR MENU -->
                <div class="profile-usermenu">
                  <ul class="nav">
                    <li class="active" style="text-align: center;">
                      <a href="mailto: it-center@ibu.edu.ba" style="font-size: 14px;">
                                                    <i class="icon-info"></i> For any questions please contact <br>venanosmic24@gmail.com </a>
                    </li>
                  </ul>
                </div>
                <!-- END MENU -->
              </div>
              <!-- END PORTLET MAIN -->

            </div>
            <!-- END BEGIN PROFILE SIDEBAR -->
            <!-- BEGIN PROFILE CONTENT -->
            <div class="profile-content">
              <div class="row">
                <div class="col-md-12">
                  <div class="portlet light ">
                    <div class="portlet-title tabbable-line">
                      <div class="caption caption-md">
                        <i class="icon-globe theme-font hide"></i>
                        <span class="caption-subject font-blue-madison bold uppercase">Data for: <span style="color:#BD0C0C; font-size: 20px;" id="servername"></span><span> server. Last time updated: </span><span style="color:#BD0C0C; font-size: 20px;"
                          id="timeupdated"></span>
                      </div>
                    </div>

                    <div class="row">
                      <div class="col-sm-12 col-lg-12">
                        <div class="panel panel-danger">
                          <div class="panel-heading">CPU INFO</div>
                          <div class="panel-body">
                            <table class="table" id="cpu">
                              <thead>
                                <tr>
                                  <th scope="col">Model</th>
                                  <th scope="col">Architecture</th>
                                  <th scope="col">Cores</th>
                                  <th scope="col">Threads</th>
                                  <th scope="col">PIDs</th>
                                  <th scope="col">Percentage</th>
                                </tr>
                              </thead>
                            </table>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-sm-12 col-lg-6">
                        <div class="panel panel-success">
                          <div class="panel-heading">OS Info</div>
                          <div class="panel-body">
                            <table class="table" id="osinfo">
                              <thead>
                                <tr>
                                  <th scope="col">OS Name</th>
                                  <th scope="col">OS Version</th>
                                  <th scope="col">Uptime</th>
                                </tr>
                              </thead>
                            </table>
                          </div>
                        </div>
                      </div>
                      <div class="col-sm-12 col-lg-6">
                        <div class="panel panel-success">
                          <div class="panel-heading">Network</div>
                          <div class="panel-body">
                            <table class="table" id="network">
                              <thead>
                                <tr>
                                  <th scope="col">Hostname</th>
                                  <th scope="col">Internal IP</th>
                                  <th scope="col">Exteral IP</th>
                                </tr>
                              </thead>
                            </table>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-sm-12 col-lg-6">
                        <div class="panel panel-primary">
                          <div class="panel-heading">RAM (GB)</div>
                          <div class="panel-body">
                            <table class="table" id="ram">
                              <thead>
                                <tr>
                                  <th scope="col">Total</th>
                                  <th scope="col">Used</th>
                                  <th scope="col">Free</th>
                                  <th scope="col">Shared</th>
                                  <th scope="col">Available</th>
                                  <th scope="col">Buffered</th>
                                </tr>
                              </thead>
                            </table>
                          </div>
                        </div>
                      </div>
                      <div class="col-sm-12 col-lg-6">
                        <div class="panel panel-primary">
                          <div class="panel-heading">SWAP (GB)</div>
                          <div class="panel-body">
                            <table class="table" id="swap">
                              <thead>
                                <tr>
                                  <th scope="col">Total</th>
                                  <th scope="col">Used</th>
                                  <th scope="col">Free</th>
                                </tr>
                              </thead>
                            </table>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-sm-12 col-lg-6">
                        <div class="panel panel-warning">
                          <div class="panel-heading">HDD (GB)</div>
                          <div class="panel-body">
                            <table class="table" id="hdd">
                              <thead>
                                <tr>
                                  <th scope="col">Total</th>
                                  <th scope="col">Used</th>
                                  <th scope="col">Free</th>
                                </tr>
                              </thead>
                            </table>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- END PROFILE CONTENT -->
          </div>
        </div>
      </div>
      <!-- END CONTENT BODY -->
    </div>
    <!-- END CONTENT -->
  </div>
  <!-- END CONTAINER -->
  <!--[if lt IE 9]>
<script src="../assets/global/plugins/respond.min.js"></script>
<script src="../assets/global/plugins/excanvas.min.js"></script>
<![endif]-->
  <!-- BEGIN CORE PLUGINS -->
  <script src="js/jquery.min.js" type="text/javascript"></script>
  <script src="js/bootstrap.min.js" type="text/javascript"></script>

  <script src="js/utils.js" type="text/javascript"></script>
  <script src="js/login.js" type="text/javascript"></script>
  <script src="bower_components/bootstrap-sweetalert/dist/sweetalert.js"></script>
</body>

<script type="text/javascript">
  var token = Utils.get_from_localstorage('auth');
  if (!Utils.get_from_localstorage('user')) {
    window.location = "/login.html";
  } else {
    $.get("rest/v1/provjeritoken/" + token).done(function(data) {
      if (data.Authorized != false) {
        Utils.check_for_hacker();
        $('.profile-image').attr('src', Utils.get_from_localstorage('user').image);
        $('.profile-name').html(Utils.get_from_localstorage('user').name);
        $('#profile-email').html(Utils.get_from_localstorage('user').email);
        $('body').show();

        //GET DATA
        get_data_for_opened_server();
      } else {
        Utils.incorrect_auth();
      }
    });
  }

  function create_new_server() {
    swal({
      title: "Add New Machine:",
      text: "Enter new server's name:",
      type: "input",
      showCancelButton: true,
      closeOnConfirm: false,
      inputPlaceholder: "Write name"
    }, function(inputValue) {
      if (inputValue === false) return false;
      if (inputValue === "") {
        swal.showInputError("You need to write something!");
        return false
      }
      $.get("rest/v1/crateserver", {authtoken: token, newname: inputValue}).done(function(data) {
        if (data.Authorized != false) {
          Utils.downoload_file("rest/v1/download/" + data, "LinuxMonitoring.py");
          swal({
              title: "Successfully Created",
              text: "To start monitoring, run downloaded file with: sudo python2 ServerMonitoring.py",
              type: "success",
              confirmButtonClass: "btn-info",
              confirmButtonText: "Close",
              closeOnConfirm: true
            },
            function() {
              get_user_servers_by_number();
            });
        } else {
          swal("Error!", "Error in: " + data, "error");
        }
      }).fail(function(error) {
        console.log(error);
      });
    });
  }

  function get_data_for_opened_server() {
    var current_url = window.location.href;
    var url = new URL(current_url);
    var auth = url.searchParams.get("auth");
    var server_name = url.searchParams.get("servername");
    $('#servername').append(server_name);

    $.get("rest/v1/getmonitordata/" + auth + "/" + token).done(function(data) {
      //console.log(data);
      if (data.Authorized != false) {
        $.each(data, function(index, item) {
          $('#timeupdated').append(item.timesubmited);
          $('#cpu').append('<tr><th scope="row">' + item.cpu_model + '</th>' + '<td>' + item.cpu_architecture + '</td>' + '<td>' + item.cpu_cores + '</td>' + '<td>' + item.cpu_threads + '</td>' + '<td>' + item.pid_running +
            '</td><td><span style="font-weight:bold; color:red;">' + item.cpu_percentage + ' %</span></td></tr>');
          $('#osinfo').append('<tr><th scope="row">' + item.os_name + '</th>' + '<td>' + item.os_version + '</td>' + '<td>' + item.uptime + ' (HH:MM)</td></tr>');
          $('#network').append('<tr><th scope="row">' + item.hostname + '</th>' + '<td>' + item.internal_ip + '</td>' + '<td>' + item.external_ip + '</td></tr>');
          $('#ram').append('<tr><th scope="row">' + item.ram_total + '</th>' + '<td>' + item.ram_used + '</td>' + '<td>' + item.ram_free + '</td>' + '<td>' + item.ram_shared + '</td>' + '<td>' + item.ram_available +
            '</td><td>' + item.ram_buff + '</td></tr>');
          $('#swap').append('<tr><th scope="row">' + item.swap_total + '</th>' + '<td>' + item.swap_used + '</td>' + '<td>' + item.swap_free + '</td></tr>');
          $('#hdd').append('<tr><th scope="row">' + item.total_hdd + '</th>' + '<td>' + item.used_hdd + '</td>' + '<td>' + item.available_hdd + '</td></tr>');
        });
      } else {
        Utils.incorrect_auth();
      }
    }).fail(function(error) {
      console.log(error.responseJSON.error);
    });
  }
</script>

</html>
